import std.io;

// Define traits
trait Drop {
    void drop();
}

trait Debug {
    void debug();
}

// A struct that manages resources
@trait(drop)
struct Resource {
    i32 id;
    i32* data;
}

// Implement Drop for Resource
impl Resource {
    void drop(Resource self) {
        printf("Resource %d dropped!\n", self.id);
        // In real code: free(self.data);
    }
    
    void debug(Resource self) {
        printf("Resource { id: %d }\n", self.id);
    }
}

// A simple copyable struct
@trait(copy)
struct Point {
    i32 x;
    i32 y;
}

impl Point {
    void debug(Point self) {
        printf("Point(%d, %d)\n", self.x, self.y);
    }
    
    // Method that returns a new Point
    Point offset(Point self, i32 dx, i32 dy) {
        Point result;
        result.x = self.x + dx;
        result.y = self.y + dy;
        return result;
    }
}

i32 main() {
    // Test Point methods - now with method call syntax!
    Point p;
    p.x = 10;
    p.y = 20;
    p.debug();
    
    Point p2 = p.offset(5, 10);
    p2.debug();
    
    // Test Resource with drop
    Resource r;
    r.id = 42;
    r.debug();
    r.drop();  // Manual drop for now
    
    printf("Done!\n");
    return 0;
}
