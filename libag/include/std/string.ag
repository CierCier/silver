// Silver Standard Library - String Type
// A dynamic string object with automatic memory management

import std.io;
import std.mem;

// C library functions we need (C compliant signatures)
extern i64 strlen(i8* s);
extern i8* strcpy(i8* dest, i8* src);
extern i8* strcat(i8* dest, i8* src);
extern i8* strncpy(i8* dest, i8* src, i64 n);
extern i32 strcmp(i8* a, i8* b);
extern i32 strncmp(i8* a, i8* b, i64 n);
extern i8* strchr(i8* s, i32 c);
extern i8* strstr(i8* haystack, i8* needle);


struct String {
    i8 *data;       // Pointer to the character data
    i64 len;     // Current length of the string
    i64 capacity;   // Allocated capacity
}

i64 STRING_INITIAL_CAPACITY = 16;

impl String{

    String new(){
        String s;
        s.len = 0;
        s.capacity = STRING_INITIAL_CAPACITY;
        s.data = alloc<i8>(s.capacity + 1); // +1 for null terminator
        s.data[0] = '\0';


        // debug
        printf("String created: capacity=%ld\n", s.capacity);
        printf("String data ptr: %p\n", s.data);
        printf("String len: %ld\n", s.len);

        return s;
    }

}